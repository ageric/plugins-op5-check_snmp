<?php
require_once('test_helper.php');
class Check_Snmp_Extend_Test extends test_helper
{
	public $plugin = 'check_by_snmp_extend';
	public $snmpdata = <<<EOF
1.3.6.1.4.1.8072.1.3.2.2.1.2.5.110.97.109.101.50|4|/bin/sh
1.3.6.1.4.1.8072.1.3.2.2.1.2.5.110.97.109.101.51|4|/bin/sh
1.3.6.1.4.1.8072.1.3.2.2.1.2.5.110.97.109.101.52|4|/bin/sh
1.3.6.1.4.1.8072.1.3.2.2.1.2.7.84.72.69.78.65.77.69|4|/bin/sh
1.3.6.1.4.1.8072.1.3.2.2.1.3.5.110.97.109.101.50|4|/home/exon/testing.sh
1.3.6.1.4.1.8072.1.3.2.2.1.3.5.110.97.109.101.51|4|/home/exon/testing.sh
1.3.6.1.4.1.8072.1.3.2.2.1.3.5.110.97.109.101.52|4|/home/exon/testing.sh
1.3.6.1.4.1.8072.1.3.2.2.1.3.7.84.72.69.78.65.77.69|4|/home/exon/testing.sh
1.3.6.1.4.1.8072.1.3.2.2.1.4.5.110.97.109.101.50|4|
1.3.6.1.4.1.8072.1.3.2.2.1.4.5.110.97.109.101.51|4|
1.3.6.1.4.1.8072.1.3.2.2.1.4.5.110.97.109.101.52|4|
1.3.6.1.4.1.8072.1.3.2.2.1.4.7.84.72.69.78.65.77.69|4|
1.3.6.1.4.1.8072.1.3.2.2.1.5.5.110.97.109.101.50|2|5
1.3.6.1.4.1.8072.1.3.2.2.1.5.5.110.97.109.101.51|2|5
1.3.6.1.4.1.8072.1.3.2.2.1.5.5.110.97.109.101.52|2|5
1.3.6.1.4.1.8072.1.3.2.2.1.5.7.84.72.69.78.65.77.69|2|5
1.3.6.1.4.1.8072.1.3.2.2.1.6.5.110.97.109.101.50|2|1
1.3.6.1.4.1.8072.1.3.2.2.1.6.5.110.97.109.101.51|2|1
1.3.6.1.4.1.8072.1.3.2.2.1.6.5.110.97.109.101.52|2|1
1.3.6.1.4.1.8072.1.3.2.2.1.6.7.84.72.69.78.65.77.69|2|1
1.3.6.1.4.1.8072.1.3.2.2.1.7.5.110.97.109.101.50|2|1
1.3.6.1.4.1.8072.1.3.2.2.1.7.5.110.97.109.101.51|2|1
1.3.6.1.4.1.8072.1.3.2.2.1.7.5.110.97.109.101.52|2|1
1.3.6.1.4.1.8072.1.3.2.2.1.7.7.84.72.69.78.65.77.69|2|1
1.3.6.1.4.1.8072.1.3.2.2.1.20.5.110.97.109.101.50|2|4
1.3.6.1.4.1.8072.1.3.2.2.1.20.5.110.97.109.101.51|2|4
1.3.6.1.4.1.8072.1.3.2.2.1.20.5.110.97.109.101.52|2|4
1.3.6.1.4.1.8072.1.3.2.2.1.20.7.84.72.69.78.65.77.69|2|4
1.3.6.1.4.1.8072.1.3.2.2.1.21.5.110.97.109.101.50|2|1
1.3.6.1.4.1.8072.1.3.2.2.1.21.5.110.97.109.101.51|2|1
1.3.6.1.4.1.8072.1.3.2.2.1.21.5.110.97.109.101.52|2|1
1.3.6.1.4.1.8072.1.3.2.2.1.21.7.84.72.69.78.65.77.69|2|1
1.3.6.1.4.1.8072.1.3.2.3.1.1.5.110.97.109.101.50|4|HALABALOO! This is output 1
1.3.6.1.4.1.8072.1.3.2.3.1.1.5.110.97.109.101.51|4|HALABALOO! This is output 2
1.3.6.1.4.1.8072.1.3.2.3.1.1.5.110.97.109.101.52|4|HALABALOO! This is output 3
1.3.6.1.4.1.8072.1.3.2.3.1.1.7.84.72.69.78.65.77.69|4|HALABALOO! This is output 4
1.3.6.1.4.1.8072.1.3.2.3.1.2.5.110.97.109.101.50|4|HALABALOO! This is output 1
1.3.6.1.4.1.8072.1.3.2.3.1.2.5.110.97.109.101.51|4|HALABALOO! This is output 2
1.3.6.1.4.1.8072.1.3.2.3.1.2.5.110.97.109.101.52|4|HALABALOO! This is output 3
1.3.6.1.4.1.8072.1.3.2.3.1.2.7.84.72.69.78.65.77.69|4|HALABALOO! This is output 4
1.3.6.1.4.1.8072.1.3.2.3.1.3.5.110.97.109.101.50|2|1
1.3.6.1.4.1.8072.1.3.2.3.1.3.5.110.97.109.101.51|2|1
1.3.6.1.4.1.8072.1.3.2.3.1.3.5.110.97.109.101.52|2|1
1.3.6.1.4.1.8072.1.3.2.3.1.3.7.84.72.69.78.65.77.69|2|1
1.3.6.1.4.1.8072.1.3.2.3.1.4.5.110.97.109.101.50|2|2
1.3.6.1.4.1.8072.1.3.2.3.1.4.5.110.97.109.101.51|2|2
1.3.6.1.4.1.8072.1.3.2.3.1.4.5.110.97.109.101.52|2|2
1.3.6.1.4.1.8072.1.3.2.3.1.4.7.84.72.69.78.65.77.69|2|2
EOF;

	/**
	 * Number of processes
	 *
	 * @dataProvider snmpArgsProvider
	 */
	public function test_running_THENAME($conn_args) {
		$this->assertCommand($conn_args, "-i THENAME", array(
		), array(
			"HALABALOO! This is output 4",
		), 2);
	}

	/**
	 * @dataProvider snmpArgsProvider
	 */
	public function test_listing($conn_args) {
		$this->assertCommand($conn_args, "--list", array(
		), array(
			"THENAME /bin/sh /home/exon/testing.sh
name2 /bin/sh /home/exon/testing.sh
name3 /bin/sh /home/exon/testing.sh
name4 /bin/sh /home/exon/testing.sh"
		), 0);
	}
}
